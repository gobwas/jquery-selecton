/**
 * jquery-selecton - jquery plugin that converts select elements.
 *
 * Version: 0.1.1
 * Date: 2014-05-13 11:16:15
 *
 * Copyright 2014, Sergey Kamardin <gobwas@gmail.com>.
 *
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Repository: https://github.com/gobwas/jquery-selecton.git
 * Location: Moscow, Russia.
 */


 !function(t,e){var n,s,i;if(s="object"==typeof module&&module.exports,n="function"==typeof define&&define.amd,s)i=require("jQuery"),module.exports=e(i);else{if(!n)return i=t.jQuery,e(i);define(["jquery"],function(t){return e(t)})}}(this,function(t){!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.noscope=t()}}(function(){return function e(t,n,s){function i(r,c){if(!n[r]){if(!t[r]){var a="function"==typeof require&&require;if(!c&&a)return a(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=n[r]={exports:{}};t[r][0].call(l.exports,function(e){var n=t[r][1][e];return i(n?n:e)},l,l.exports,e,t,n,s)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)i(s[r]);return i}({1:[function(e){var n,s=t,i=e("./selecton"),o=e("./selecton/processor"),r=e("./selecton/processor/dropdown"),c=e("./selecton/processor/buttons"),a=e("./selecton/utils"),l=a.isFunction,u=a.isString;n=s.fn.selecton,s.fn.selecton=function(t){var e;return e=Array.prototype.slice.call(arguments,1),this.map(function(){var n,o,r;return u(t)?(o=t,t={}):t||(t={}),u(t.processor)&&l(r=s.fn.selecton.processors[t.processor])&&(t.processor=new r),n=s(this).data("selecton"),n||(n=new i(this,t),n.initialize(),s(this).data("selecton",n)),o&&l(n[o])?n[o].apply(n,e):n})},s.fn.selecton.processor=o,s.fn.selecton.processors={button:c,dropdown:r},s.fn.selecton.noConflict=function(){s.fn.selecton=n}},{"./selecton":2,"./selecton/processor":4,"./selecton/processor/buttons":5,"./selecton/processor/dropdown":6,"./selecton/utils":8}],2:[function(e,n){var s,i=t,o=e("./selecton/processor");s=function(t,e){var n;if(e=e||{},!((n=e.processor)instanceof o))throw new TypeError("Processor is expected");this.target=t,this.$target=i(t),this.processor=n,this.options=i.extend(!0,{},s.DEFAULTS,e),this.units=[]},s.prototype=function(){var t;return t=function(t){var e;t.hide(),(e=t.attr("id"))&&t.parent().find('label[for="'+e+'"]').hide()},{constructor:s,initialize:function(){var e,n,s,o;n=this,o=this.processor,o.bind(i.proxy(this.select,this)),e=this.options.source,this.selected=null,this.inputs=[],this.data=[],this.items=[],this.buttons=[],o.initialize(this.target),s=[],e.tagName&&s.push(e.tagName),e.selector&&s.push(e.selector),s=s.join(""),this.$target.find(s).each(function(t,s){var r,c,a;r=i(s),r.data(n.options.storageKey,{id:t}),n.inputs[t]=r,c={},i.each(e.data,function(t,e){var n,s;n=r[e.selector],c[t]=(s=e.key)?n.call(r,s):n.call(r)}),(a=o.unit(c,t))&&(n.units[t]=a)}),this.$target.on("destroy",i.proxy(n.destroy,n)),this.$target.on("change",i.proxy(n.onChange,n)),o.finalize(),t(this.$target)},destroy:function(){this.processor.destroy()},select:function(t){var e,n=this;e=this.options.source,null!==n.selected&&n.inputs[n.selected][e.data.selected.selector](e.data.selected.key,!1),n.inputs[t][e.data.selected.selector](e.data.selected.key,!0),n.selected!==t&&(n.$target.trigger("change"),n.selected=t)}}}(),s.DEFAULTS={storageKey:"selecton-storage",source:{tagName:"option",selector:null,data:{value:{selector:"attr",key:"value"},title:{selector:"attr",key:"title"},content:{selector:"text"},selected:{selector:"prop",key:"selected"},disabled:{selector:"prop",key:"disabled"},"class":{selector:"attr",key:"class"},skip:{selector:"data",key:"selecton-skip"}}}},i.event.special.destroy||(i.event.special.destroy={remove:function(t){t.handler&&t.handler()}}),n.exports=s},{"./selecton/processor":4}],3:[function(t,e){var n=function(t,e,n){var s;n||(n=null);for(var i in t)if(t.hasOwnProperty(i)&&(s=e.call(n,t[i],i,t),void 0!==s))return s;return s},s=function(t){for(var e=Array.prototype.slice.call(arguments,1),s=function(e,n){t[n]=e},i=0;i<e.length;i++)n(e[i],s);return t},i=function(t,e,n){function i(){}var o;return e||(e={}),n||(n={}),o=e.hasOwnProperty("constructor")&&"function"==typeof e.constructor?e.constructor:function(){t.apply(this,arguments)},s(o,t,n),i.prototype=t.prototype,o.prototype=new i,s(o.prototype,e,{constructor:o}),o.__super__=t.prototype,o};e.exports=i},{}],4:[function(e,n){var s,i=t,o=e("./utils"),r=e("./inherits"),c=e("./unit"),a=o.isObject,l=o.isString,u=o.isFunction,h=o.isArray;s=function(t){t=t||{},this.options=i.extend(!0,{},this.constructor.DEFAULTS,t),this.handlers={},this.selecton=null,this.target=null,this.content=null,this.list=null,this.units=[],this.items={},this.buttons={},this.selected=null},s.prototype={constructor:s,events:{click:{button:"onButtonClick"}},_switchClass:function(t,e,n){l(e)?t.toggleClass(e,!!n):h(e)&&(t.addClass(e[+!!n]),t.removeClass(e[+!n]))},_createElement:function(){var t=function(t){return["<",t,"/>"].join("")};return function(e,n){var s,o,r,c=this;return s=i(t(e.tagName)).addClass(e.className),a(n)&&a(r=e.onData)&&i.each(n,function(t,e){r.attributes&&-1!==r.attributes.indexOf(t)&&s.attr(t,e),r.properties&&-1!==r.properties.indexOf(t)&&s.prop(t,e),r.classes&&(o=r.classes[t])&&c._switchClass(s,o,e),r.content&&r.content===t&&s.text(e)}),s}}(),_delegateEvents:function(){var t=this;i.each(this.events,function(e,n){i.each(n,function(n,s){var o;(o=t.options.view[n])&&t.content.on([e,t.options.event_namespace].join("."),[o.tagName,o.className.split(" ").join(".")].join("."),i.proxy(t[s],t))})})},initialize:function(t){this.target=i(t),this.list=this.createList(),this.content=this.createContent(),this.content.append(this.list)},finalize:function(){var t=this;i.each(this.units,function(e,n){t.iterator(n)}),this.sort(),i.each(this.units,function(e,n){var s,i;s=t.items[n.id],i=t.buttons[n.id],s.append(i),t.list.append(s)}),this.content.insertAfter(this.target),this._delegateEvents()},createList:function(){return this._createElement(this.options.view.list)},createContent:function(){return this._createElement(this.options.view.content)},createItem:function(t){return this._createElement(this.options.view.item,t)},createButton:function(t){return this._createElement(this.options.view.button,t)},unit:function(t,e){var n,s,i,o=this;return n=new c(e,t),this.filter(n)?(this.units.push(n),this.items[e]=s=this.createItem(t),this.buttons[e]=i=this.createButton(t),s.data(o.options.storageKey,{id:e}),i.data(o.options.storageKey,{id:e}),n.data.selected&&(this.selected=e),n):null},findUnit:function(t){var e,n;for(a(t)||(t={id:t}),n=0;n<this.units.length;n++){if(e=this.units[n],void 0!=t.id&&e.id===t.id)return e;if(void 0!=t.value&&e.data.value===t.value)return e}return null},sort:function(){var t,e=this;return t=i.map(this.units,function(t,n){var s;return s=e.comparator(t,n),{index:n,criteria:s,unit:t}}),t.sort(function(t,e){var n=t.criteria,s=e.criteria;if(n!==s){if(n>s||void 0===n)return 1;if(s>n||void 0===s)return-1}return t.index<e.index?-1:1}),this.units=i.map(t,function(t){return t.unit})},filter:function(t){if(!(t instanceof c))throw new TypeError("Unit is expected");return!t.data.skip},bind:function(t){this.selecton=t},notify:function(t){this.selecton(t)},select:function(t){var e;if(this.selected!==t){try{e=this.options.view.item.onData.classes.selected}catch(n){}e&&(null!==this.selected&&this._switchClass(this.items[this.selected],e,!1),this._switchClass(this.items[t],e,!0));try{e=this.options.view.button.onData.classes.selected}catch(n){}e&&(null!==this.selected&&this._switchClass(this.buttons[this.selected],e,!1),this._switchClass(this.buttons[t],e,!0)),this.selected=t,this.notify(t)}},setHandler:function(t,e){this.handlers[t]&&(this.handlers[t]=e)},onChange:function(){var t;(t=this.findUnit({value:this.target.val()}))&&this.select(t.id)},onButtonClick:function(t){var e,n,s,o,r,c=this;e=i(t.currentTarget),n=e.data(this.options.storageKey),s=n.id,r=this.handlers.click,(o=this.findUnit(s))&&(u(r)?i.when(r.call(null,t,o)).then(function(){c.select(s)}):this.select(s))},find:function(t,e){var n=this,s=[];return"button"==t&&(i.each(this.units,function(t,n){e.call(null,n)&&s.push(n)}),s=i.map(s,function(t){return{button:n.buttons[t.id],item:n.items[t.id]}})),s},comparator:function(){},iterator:function(){},destroy:function(){}},s.DEFAULTS={storageKey:"selecton-storage",event_namespace:"selecton",view:{content:{tagName:"div",className:"selecton",onData:{attributes:[],properties:[],html:null,classes:null}},list:{tagName:"ul",className:"selecton-options",onData:{attributes:["class"],properties:[],content:null,classes:null}},item:{tagName:"li",className:"selecton-option",onData:{attributes:["class"],properties:[],content:null,classes:{selected:"is--active",disabled:"is--disabled"}}},button:{tagName:"button",className:"selecton-button",onData:{attributes:["title"],properties:["disabled"],content:"content",classes:{selected:"is--active",disabled:"is--disabled"}}}}},s.extend=function(t,e){return r(this,t,e)},n.exports=s},{"./inherits":3,"./unit":7,"./utils":8}],5:[function(t,e){var n=t("../processor");e.exports=n.extend({})},{"../processor":4}],6:[function(e,n){var s=t,i=e("../utils"),o=i.isFunction,r=e("../processor");n.exports=r.extend({events:s.extend(!0,{click:{tumbler:"onToggleClick"}},r.prototype.events),constructor:function(){r.prototype.constructor.apply(this,arguments),this.visibile=null,this.eventNamespace=null},initialize:function(){r.prototype.initialize.apply(this,arguments),this.eventNamespace=["selecton-dropdown",(new Date).getTime(),Math.floor(1e4*Math.random())].join("-"),this.tumbler=this.createTumbler(),this.content.prepend(this.tumbler)},finalize:function(){r.prototype.finalize.apply(this,arguments),this.refreshTumblerCaption(),this.toggle(!1)},createTumbler:function(){return this._createElement(this.options.view.tumbler)},refreshTumblerCaption:function(){var t,e;null!==(t=this.selected)&&(e=this.findUnit(t))&&this.tumbler.text(e.data.content)},onToggleClick:function(t){var e,n=this;e=this.handlers.toggle,o(e)?s.when(e.call(null,t)).then(function(){n.toggle()}):this.toggle()},_toggleEvent:function(){var t;return function(){return t||(t=["click",this.eventNamespace].join("."))}}(),_hide:function(){var t,e=this;try{t=this.options.view.tumbler.onData.classes.toggle}catch(n){}return t&&this._switchClass(this.tumbler,t,!1),s.when(this.animateListOut()).then(function(){return e.visible=!1})},_show:function(){var t,e=this;try{t=this.options.view.tumbler.onData.classes.toggle}catch(n){}return t&&this._switchClass(this.tumbler,t,!0),s.when(this.animateListIn()).then(function(){return setTimeout(function(){s(document).on(e._toggleEvent(),function(t){-1==s(t.target).parents().index(e.list)&&(e._hide(),s(document).off(e._toggleEvent()))})},0),e.visible=!0})},animateListIn:function(){return this.list.show()},animateListOut:function(){return this.list.hide()},select:function(){r.prototype.select.apply(this,arguments),s(document).off(this._toggleEvent()),this.refreshTumblerCaption(),this.visible===!0&&this.toggle()},toggle:function(t){var e;return e=void 0==t?!this.visible:t,e?this._show():this._hide()}},s.extend(!0,{DEFAULTS:{view:{tumbler:{tagName:"button",className:"selecton-tumbler",onData:{classes:{toggle:"is--active"}}}}}},r))},{"../processor":4,"../utils":8}],7:[function(e,n){var s,i=t;s=function(t,e){this.id=t,this.data={},i.extend(this.data,e)},s.prototype={constructor:s},n.exports=s},{}],8:[function(t,e){var n,s,i,o;n=function(t){return"[object Function]"==Object.prototype.toString.call(t)},s=function(t){return void 0!=t&&"[object Object]"==Object.prototype.toString.call(t)},i=function(t){return"[object String]"==Object.prototype.toString.call(t)},o=function(t){return"[object Array]"==Object.prototype.toString.call(t)},e.exports.isFunction=n,e.exports.isObject=s,e.exports.isString=i,e.exports.isArray=o},{}]},{},[1])(1)})});